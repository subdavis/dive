
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for DIVE">
      
      
        <meta name="author" content="Kitware">
      
      
        <link rel="canonical" href="https://kitware.github.io/dive/Deployment-Docker-Compose/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.1">
    
    
      
        <title>Running with Docker Compose - DIVE</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e8d9bf0c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#running-with-docker-compose" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DIVE" class="md-header__button md-logo" aria-label="DIVE" data-md-component="logo">
      
  <img src="../images/General/Kitware-Mark.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DIVE
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Running with Docker Compose
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Kitware/dive/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        User Guide
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../Pipeline-Documentation/" class="md-tabs__link">
      Pipelines & Training
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../DataFormats/" class="md-tabs__link">
      Data Formats
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../Deployment-Overview/" class="md-tabs__link md-tabs__link--active">
        Administrator Guide
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../FAQ/" class="md-tabs__link">
      Frequently Asked Questions
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../Support/" class="md-tabs__link">
      Support
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DIVE" class="md-nav__button md-logo" aria-label="DIVE" data-md-component="logo">
      
  <img src="../images/General/Kitware-Mark.png" alt="logo">

    </a>
    DIVE
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Kitware/dive/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" data-md-state="indeterminate" type="checkbox" id="__nav_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Web-Version/" class="md-nav__link">
        Web Version
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Dive-Desktop/" class="md-nav__link">
        Desktop Version
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Annotation-QuickStart/" class="md-nav__link">
        Annotation Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_5" data-md-state="indeterminate" type="checkbox" id="__nav_1_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1_5">
          User Interface Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Interface Guide" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_5">
          <span class="md-nav__icon md-icon"></span>
          User Interface Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Annotation-User-Interface-Overview/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Navigation-Editing-Bar/" class="md-nav__link">
        Navigation and Editing Bar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Annotation-View/" class="md-nav__link">
        Annotation Window
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Type-List/" class="md-nav__link">
        Type List
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Track-List/" class="md-nav__link">
        Track List
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Timeline/" class="md-nav__link">
        Timeline
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UI-Attributes/" class="md-nav__link">
        Attributes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Mouse-Keyboard-Shortcuts/" class="md-nav__link">
        Keyboard Shortcut Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1_7" data-md-state="indeterminate" type="checkbox" id="__nav_1_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_1_7">
          Advanced features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced features" data-md-level="2">
        <label class="md-nav__title" for="__nav_1_7">
          <span class="md-nav__icon md-icon"></span>
          Advanced features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Pipeline-Import-Export/" class="md-nav__link">
        Pipeline Import and Export
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Command-Line-Tools/" class="md-nav__link">
        Command Line Tools
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Screenshots/" class="md-nav__link">
        Screenshots
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Support/" class="md-nav__link">
        Support
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Pipeline-Documentation/" class="md-nav__link">
        Pipelines & Training
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../DataFormats/" class="md-nav__link">
        Data Formats
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Administrator Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Administrator Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Administrator Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Deployment-Overview/" class="md-nav__link">
        Deployment Options Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Deployment-Provision/" class="md-nav__link">
        Provisioning Google Cloud
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Running with Docker Compose
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Running with Docker Compose
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#container-images" class="md-nav__link">
    Container Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-dependencies" class="md-nav__link">
    Install dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-deployment" class="md-nav__link">
    Basic deployment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-deployment" class="md-nav__link">
    Production deployment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addon-management" class="md-nav__link">
    Addon management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-reference" class="md-nav__link">
    Configuration Reference
  </a>
  
    <nav class="md-nav" aria-label="Configuration Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#web-server-config" class="md-nav__link">
    Web Server config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#worker-config" class="md-nav__link">
    Worker config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-gpu-job-runner-in-standalone-mode" class="md-nav__link">
    Running the GPU Job Runner in standalone mode
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Deployment-Storage/" class="md-nav__link">
        Cloud Storage Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://viame.kitware.com/api/v1" class="md-nav__link">
        REST API Specification
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../FAQ/" class="md-nav__link">
        Frequently Asked Questions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../Support/" class="md-nav__link">
        Support
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#container-images" class="md-nav__link">
    Container Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-dependencies" class="md-nav__link">
    Install dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-deployment" class="md-nav__link">
    Basic deployment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-deployment" class="md-nav__link">
    Production deployment
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#addon-management" class="md-nav__link">
    Addon management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-reference" class="md-nav__link">
    Configuration Reference
  </a>
  
    <nav class="md-nav" aria-label="Configuration Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#web-server-config" class="md-nav__link">
    Web Server config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#worker-config" class="md-nav__link">
    Worker config
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-the-gpu-job-runner-in-standalone-mode" class="md-nav__link">
    Running the GPU Job Runner in standalone mode
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/Kitware/dive/edit/master/docs/Deployment-Docker-Compose.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="running-with-docker-compose">Running with Docker Compose</h1>
<p>Start here once you have SSH access and <code>sudo</code> privileges for a server or VM. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Docker server installation is only supported on Linux distributions</p>
</div>
<h2 id="container-images">Container Images</h2>
<p>A DIVE Web deployment consists of 2 main services.</p>
<ul>
<li><a href="https://hub.docker.com/r/kitware/viame-web">kitware/viame-web</a> - the web server</li>
<li><a href="https://hub.docker.com/r/kitware/viame-worker">kitware/viame-worker</a> - the queue worker</li>
</ul>
<p>In addition, a database (MongoDB) and a queue service (RabbitMQ) are required.</p>
<p><img alt="DIVE-Web-Architecture-Diagram.svg" src="../images/Diagrams/DIVE-Web-Architecture-Diagram.svg" /></p>
<h2 id="install-dependencies">Install dependencies</h2>
<p>SSH into the target server and install these system dependencies.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can skip this section if you used Ansible to configure your server, as it already installed all necessary dependencies.</p>
</div>
<ul>
<li>Install NVIDIA driver version <strong>&gt;= 450.80.02</strong> and <strong>CUDA 11.0+</strong> <code>sudo ubuntu-drivers install</code></li>
<li>Install <code>docker</code> version <strong>19.03+</strong> <a href="https://docs.docker.com/engine/install/ubuntu/">guide</a></li>
<li>Install <code>docker-compose</code> version <strong>1.28.0+</strong> <a href="https://docs.docker.com/compose/install/">guide</a></li>
<li>Install <a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html#docker">nvidia-container-toolkit</a></li>
</ul>
<h2 id="basic-deployment">Basic deployment</h2>
<p>Clone this repository and configure options in <code>.env</code> .</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1"># Clone this repository</span>
git clone https://github.com/Kitware/dive /opt/dive

<span class="c1"># Change to correct directory</span>
<span class="nb">cd</span> /opt/dive

<span class="c1"># Initiate the .env file</span>
cp .env.default .env

<span class="c1"># Edit the .env file</span>
<span class="c1"># See configuration options below and inline comments</span>
nano .env

<span class="c1"># Pull pre-built images</span>
docker-compose pull

<span class="c1"># Bring the services up</span>
<span class="c1"># Make sure to specify docker-compose.yml unless you intend to mount code for development</span>
docker-compose -f docker-compose.yml up -d
</code></pre></div>
</td></tr></table>
<p>VIAME server will be running at <a href="http://localhost:8010/">http://localhost:8010</a>. You should see a page that looks like this. The default username and password is <code>admin:letmein</code>.</p>
<p><img alt="Login Page" src="../images/General/login.png" /></p>
<h2 id="production-deployment">Production deployment</h2>
<p>If you have a server with a <strong>public-facing IP address</strong> and a <strong>domain name</strong> that points to it, you should be able to use our production deployment configuration.  This is the way we deploy viame.kitware.com.</p>
<ul>
<li><code>containrrr/watchtower</code> updates the running containers on a schedule using automated image builds from docker hub (above).</li>
<li><code>linuxserver/duplicati</code> is included to schedule nightly backups, but must be manually configured.</li>
</ul>
<p>You should scale the girder web server up to an appropriate number.  This stack will automatically load-balance across however many instances you bring up.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="c1"># Continuing from above, modify .env again to include the production variables</span>
nano .env

<span class="c1"># pull extra containers</span>
docker-compose -f docker-compose.yml -f docker-compose.prod.yml pull

<span class="c1"># scale the web service up</span>
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d --scale <span class="nv">girder</span><span class="o">=</span><span class="m">4</span>
</code></pre></div>
</td></tr></table>
<h2 id="addon-management">Addon management</h2>
<p>After initial deployment, a DIVE server will only have basic VIAME pipelines available. VIAME optional patches are installed and upgraded using a celery task that must be triggered by hand. Run this by issuing a <u><code>POST /dive_configuration/upgrade_pipelines</code></u> request from the swagger UI at <code>http://{domain}/api/v1</code> .</p>
<ul>
<li>Whether you <code>force</code> or not, only those pipelines from addons from the exact urls passed will be enabled on the server.</li>
<li>An old addon can be disabled by simply omitting its download from the upgrade payload.</li>
<li><code>force</code> should be used to force re-download of all URLs in the payload even if their zipfiles have been cached.</li>
<li>An upgrade run is always required if the "common" pipelines in the base image change.  These are updated for every run, and do not require <code>force</code>.</li>
<li>See the job log to verify the exact actions taken by an upgrade job.</li>
</ul>
<p><img alt="Upgrade Pipelines Swagger" src="../images/UpgradePipelinesSwagger.png" /></p>
<h2 id="configuration-reference">Configuration Reference</h2>
<h3 id="web-server-config">Web Server config</h3>
<p>This image contains both the backend and client.</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>GIRDER_MONGO_URI</td>
<td><code>mongodb://mongo:27017/girder</code></td>
<td>a mongodb connection string</td>
</tr>
<tr>
<td>GIRDER_ADMIN_USER</td>
<td><code>admin</code></td>
<td>admin username</td>
</tr>
<tr>
<td>GIRDER_ADMIN_PASS</td>
<td><code>letmein</code></td>
<td>admin password</td>
</tr>
<tr>
<td>CELERY_BROKER_URL</td>
<td><code>amqp://guest:guest@default/</code></td>
<td>rabbitmq connection string</td>
</tr>
<tr>
<td>WORKER_API_URL</td>
<td><code>http://girder:8080/api/v1</code></td>
<td>Address for workers to reach web server</td>
</tr>
</tbody>
</table>
<p>There is additional configuration for the RabbitMQ Management plugin. It only matters if you intend to allow individual users to configure private job runners in standalone mode, and can otherwise be ignored.</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>RABBITMQ_MANAGEMENT_USERNAME</td>
<td><code>guest</code></td>
<td>Management API username</td>
</tr>
<tr>
<td>RABBITMQ_MANAGEMENT_PASSWORD</td>
<td><code>guest</code></td>
<td>Management API password</td>
</tr>
<tr>
<td>RABBITMQ_MANAGEMENT_VHOST</td>
<td><code>default</code></td>
<td>Virtual host should match <code>CELERY_BROKER_URL</code></td>
</tr>
<tr>
<td>RABBITMQ_MANAGEMENT_URL</td>
<td><code>http://rabbit:15672/</code></td>
<td>Management API Url</td>
</tr>
</tbody>
</table>
<p>You can also pass <a href="https://girder.readthedocs.io/en/latest/">girder configuration</a> and <a href="https://docs.celeryproject.org/en/stable/userguide/configuration.html#std-setting-broker_connection_timeout">celery configuration</a>.</p>
<h3 id="worker-config">Worker config</h3>
<p>This image contains a celery worker to run VIAME pipelines and transcoding jobs.</p>
<blockquote>
<p><strong>Note</strong>: Either a broker url or DIVE credentials must be supplied.</p>
</blockquote>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>WORKER_WATCHING_QUEUES</td>
<td>null</td>
<td>one of <code>celery</code>, <code>pipelines</code>, <code>training</code>.  Ignored in standalone mode.</td>
</tr>
<tr>
<td>WORKER_CONCURRENCY</td>
<td><code># of CPU cores</code></td>
<td>max concurrnet jobs. <strong>Lower this if you run training</strong></td>
</tr>
<tr>
<td>WORKER_GPU_UUID</td>
<td>null</td>
<td>leave empty to use all GPUs.  Specify UUID to use specific device</td>
</tr>
<tr>
<td>CELERY_BROKER_URL</td>
<td><code>amqp://guest:guest@default/</code></td>
<td>rabbitmq connection string. Ignored in standalone mode.</td>
</tr>
<tr>
<td>KWIVER_DEFAULT_LOG_LEVEL</td>
<td><code>warn</code></td>
<td>kwiver log level</td>
</tr>
<tr>
<td>DIVE_USERNAME</td>
<td>null</td>
<td>Username to start private queue processor. Providing this enables standalone mode.</td>
</tr>
<tr>
<td>DIVE_PASSWORD</td>
<td>null</td>
<td>Password for private queue processor. Providing this enables standalone mode.</td>
</tr>
<tr>
<td>DIVE_API_URL</td>
<td><code>https://viame.kitware.com/api/v1</code></td>
<td>Remote URL to authenticate against</td>
</tr>
</tbody>
</table>
<p>You can also pass <a href="https://docs.celeryproject.org/en/stable/userguide/configuration.html#std-setting-broker_connection_timeout">regular celery configuration variables</a>.</p>
<h2 id="running-the-gpu-job-runner-in-standalone-mode">Running the GPU Job Runner in standalone mode</h2>
<p><strong>Linux Only.</strong></p>
<p>Individual users can run a standalone worker to process private jobs from VIAME Web.</p>
<ul>
<li>Install VIAME from <a href="https://github.com/VIAME/VIAME">the github page</a> to <code>/opt/noaa/viame</code>.</li>
<li>Activate the install with <code>source setup_viame.sh</code>.</li>
<li>Install VIAME pipeline addons by running <code>cd bin &amp;&amp; download_viame_addons.sh</code> from the VIAME install directory.</li>
<li>Enable the private user queue for your jobs by visiting <a href="https://viame.kitware.com/#/jobs">the jobs page</a></li>
<li>Run a worker using the docker command below</li>
</ul>
<blockquote>
<p><strong>Note</strong>: The <code>--volume</code> mount maps to the host installation.  You may need to change the source from <code>/opt/noaa/viame</code> depending on your install location, but <strong>you should not</strong> change the destination from <code>/tmp/addons/extracted</code>.</p>
</blockquote>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>docker run --rm --name dive_worker <span class="se">\</span>
  --gpus all <span class="se">\</span>
  --ipc host <span class="se">\</span>
  --volume <span class="s2">&quot;/opt/noaa/viame/:/tmp/addons/extracted:ro&quot;</span> <span class="se">\</span>
  -e <span class="s2">&quot;WORKER_CONCURRENCY=2&quot;</span> <span class="se">\</span>
  -e <span class="s2">&quot;DIVE_USERNAME=CHANGEME&quot;</span> <span class="se">\</span>
  -e <span class="s2">&quot;DIVE_PASSWORD=CHANGEME&quot;</span> <span class="se">\</span>
  -e <span class="s2">&quot;DIVE_API_URL=https://viame.kitware.com/api/v1&quot;</span> <span class="se">\</span>
  kitware/viame-worker:latest
</code></pre></div>
</td></tr></table>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../Deployment-Provision/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Provisioning Google Cloud" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Provisioning Google Cloud
            </div>
          </div>
        </a>
      
      
        
        <a href="../Deployment-Storage/" class="md-footer__link md-footer__link--next" aria-label="Next: Cloud Storage Integration" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Cloud Storage Integration
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/kitware/dive" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://hub.docker.com/r/kitware/viame-web" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://discourse.kitware.com/c/viame-dive/17" target="_blank" rel="noopener" title="discourse.kitware.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M225.9 32C103.3 32 0 130.5 0 252.1 0 256 .1 480 .1 480l225.8-.2c122.7 0 222.1-102.3 222.1-223.9C448 134.3 348.6 32 225.9 32zM224 384c-19.4 0-37.9-4.3-54.4-12.1L88.5 392l22.9-75c-9.8-18.1-15.4-38.9-15.4-61 0-70.7 57.3-128 128-128s128 57.3 128 128-57.3 128-128 128z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.expand"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.8aa65030.min.js"></script>
      
    
  </body>
</html>